{"version":3,"sources":["webpack:///../matrix-react-sdk-v3/src/async-components/views/dialogs/security/ExportE2eKeysDialog.js","webpack:///../matrix-react-sdk-v3/node_modules/file-saver/dist/FileSaver.min.js","webpack:///../matrix-react-sdk-v3/src/utils/MegolmExportEncryption.js"],"names":["ExportE2eKeysDialog","React","Component","constructor","props","super","ev","preventDefault","passphrase","this","_passphrase1","current","value","_passphrase2","setState","errStr","_t","length","nbr","_startExport","onFinished","_unmounted","createRef","state","phase","componentWillUnmount","Promise","resolve","then","matrixClient","exportRoomKeys","k","MegolmExportEncryption","JSON","stringify","f","blob","Blob","type","FileSaver","saveAs","catch","e","console","error","msg","friendlyText","render","BaseDialog","sdk","disableForm","btnLabel","isLogout","className","title","onSubmit","_onPassphraseFormSubmit","htmlFor","ref","id","autoFocus","size","disabled","onClick","_onCancelClick","PropTypes","instanceOf","MatrixClient","isRequired","bool","func","c","a","b","d","XMLHttpRequest","open","responseType","onload","g","response","onerror","send","status","dispatchEvent","MouseEvent","document","createEvent","initMouseEvent","window","self","global","navigator","test","userAgent","HTMLAnchorElement","prototype","h","i","URL","webkitURL","j","createElement","name","download","rel","href","origin","location","target","createObjectURL","setTimeout","revokeObjectURL","msSaveOrOpenBlob","autoBom","warn","body","innerText","HTMLElement","safari","FileReader","onloadend","result","replace","readAsDataURL","l","m","module","exports","TextEncoder","TextEncodingUtf8","TextDecoder","subtleCrypto","crypto","subtle","webkitSubtle","friendlyError","Error","cryptoFailMsg","async","decryptMegolmKeyFile","data","password","fileStr","decode","Uint8Array","lineStart","lineEnd","indexOf","line","slice","trim","HEADER_LINE","dataStart","undefined","dataEnd","base64","latin1String","atob","uint8Array","charCodeAt","decodeBase64","unpackMegolmKeyFile","brand","SdkConfig","get","ciphertextLength","salt","subarray","iv","iterations","ciphertext","hmac","aesKey","hmacKey","deriveKeys","toVerify","isValid","plaintext","verify","decrypt","counter","encryptMegolmKeyFile","options","kdfRounds","kdf_rounds","getRandomValues","encodedData","encode","encrypt","cipherArray","bodyLength","resultBuffer","idx","set","toSign","sign","hmacArray","nLines","Math","ceil","lines","Array","o","encodeBase64","join","buffer","packMegolmKeyFile","start","Date","key","keybits","importKey","deriveBits","hash","now","log","aesProm","hmacProm","all","String","fromCharCode","apply","btoa"],"mappings":"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","file":"bundles/b979a72c9b608a56f880/3.js","sourceRoot":""}